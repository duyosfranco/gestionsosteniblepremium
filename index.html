<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Gesti√≥n Sostenible ‚Äî Inicio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="prefetch" href="clientes-firestore.html" as="document" />
  <link rel="prefetch" href="retiros.html" as="document" />
  <link rel="prefetch" href="finanzas.html" as="document" />
  <link rel="prefetch" href="usuarios.html" as="document" />
  <link rel="prefetch" href="configuracion.html" as="document" />
  <link rel="prefetch" href="temas.html" as="document" />
  <style>
    :root{
      --ink:#0D2B3D; --ink2:#0b1f2a;
      --bg:#f3f7fb; --bg2:#fbfdff;
      --card:#fff; --overlay:rgba(15,51,70,.55);
      --accent:#1DBF73; --accent2:#16a062; --accent3:#13a660; --accent-soft:#E8FFF5;
      --muted:#6b7c8a; --line:#e6eef5;
      --nav:#0f3346; --nav2:#0b2a3b;
      --nav-contrast:#ffffff; --nav-contrast-soft:rgba(255,255,255,.85); --nav-contrast-muted:rgba(255,255,255,.65);
      --shadow:0 16px 45px rgba(13,43,61,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Helvetica,Arial,sans-serif;
      color:var(--ink2);
      background:radial-gradient(circle at top left, rgba(29,191,115,.08), transparent 42%),
                 radial-gradient(circle at bottom right, rgba(15,51,70,.08), transparent 45%),
                 linear-gradient(180deg,var(--bg) 0%, var(--bg2) 100%);
      text-rendering:optimizeLegibility;
      -webkit-font-smoothing:antialiased;
    }
    @media (prefers-reduced-motion: reduce){
      *,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}
    }
    .hidden{display:none}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

    /* Landing + login (unauthenticated view) */
    body:not(.app-ready) #appView{display:none!important}
    body:not(.app-ready) #loginView{display:block!important}
    body.app-ready #loginView{display:none!important}

    .login-panel{display:none}
    body.login-open .login-panel{display:grid}
    body.login-open .landing-shell{display:none}

    .login-wrap{background:var(--bg);color:var(--ink2);min-height:100vh}
    .landing-shell{min-height:100vh;display:flex;flex-direction:column;gap:50px}
    .landing-hero{background:linear-gradient(180deg,#0d2b3d 0%,#0a3f57 80%);color:#eaf7ff;position:relative;overflow:hidden}
    .landing-hero::after{content:"";position:absolute;inset:0;background:radial-gradient(900px 460px at -10% -20%,rgba(23,195,123,.22),transparent 60%),radial-gradient(700px 520px at 110% 10%,rgba(12,114,150,.24),transparent 60%);pointer-events:none}
    .hero-wrap{max-width:1120px;margin:0 auto;padding:38px 20px 60px;position:relative;z-index:1}
    .site-header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0 18px}
    .nav-links{display:flex;gap:16px;align-items:center;font-weight:600;color:#d9f1ff}
    .nav-links a{padding:9px 12px;border-radius:10px;text-decoration:none;color:inherit}
    .nav-links a:hover{background:rgba(255,255,255,.12)}
    .hero-grid{display:grid;grid-template-columns:1.05fr .95fr;gap:30px;align-items:center;margin-top:12px}
    .login-pill{display:inline-flex;align-items:center;gap:6px;padding:7px 12px;border-radius:999px;font-weight:700;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.28);color:#ccecff;font-size:13px;margin-bottom:8px}
    .landing-hero h1{margin:6px 0 12px;font-size:38px;line-height:1.16;letter-spacing:.01em;color:#fff}
    .landing-hero p{margin:0 0 16px;color:rgba(234,247,255,.9);max-width:620px}
    .login-cta{display:flex;gap:12px;flex-wrap:wrap;margin:10px 0 14px}
    .login-cta .btn{height:46px;padding:0 18px}
    .laptop-mock{position:relative;justify-self:end}
    .laptop-top{background:#0e1c25;border-radius:16px 16px 0 0;padding:12px;border:1px solid #0c3f53;box-shadow:0 22px 38px rgba(0,0,0,.5);position:relative;overflow:hidden}
    .laptop-camera{width:10px;height:10px;border-radius:50%;background:#1a3242;margin:0 auto 8px}
    .laptop-screen{display:block;width:100%;border-radius:8px;border:1px solid #183e55;box-shadow:inset 0 0 12px rgba(0,0,0,.35)}
    .laptop-top::after{content:"";position:absolute;inset:0;background:linear-gradient(120deg,rgba(255,255,255,.16),rgba(255,255,255,.03) 60%,transparent 100%);mix-blend-mode:overlay;pointer-events:none}
    .laptop-base{width:92%;height:18px;margin:0 auto;border-radius:0 0 16px 16px;background:linear-gradient(90deg,#8f9ea7,#cad3da,#8f9ea7);box-shadow:0 12px 26px rgba(0,0,0,.38)}
    .feature-section{padding:64px 0;background:var(--bg)}
    .wrap{max-width:1120px;margin:0 auto;padding:0 20px}
    .kicker{color:var(--accent2);font-weight:800;letter-spacing:.4px;margin-bottom:.4rem}
    .feature-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-top:14px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:18px;box-shadow:0 12px 26px rgba(13,43,61,.08)}
    .card h3{margin:.2rem 0 .4rem}
    .card p{margin:0;color:var(--muted);line-height:1.5}
    .steps{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-top:14px}
    .step .num{width:36px;height:36px;border-radius:999px;background:#e8f3fa;color:#0f5270;display:grid;place-items:center;font-weight:800;margin-bottom:8px}
    .cta-final{background:linear-gradient(180deg,#0f3346 0%,#0b2a3b 100%);color:#dff4ff;border-top:1px solid #0e4156}
    .cta-final .card{background:#0f364a;border-color:#16536a;color:#dff4ff}
    .cta-final p{color:#cfeaf3}

    .login-panel{min-height:90vh;place-items:center;padding:40px 18px;background:linear-gradient(160deg,#0a2433 0%,#0c3a54 60%,#0a4a67 100%);color:#eaf7ff}
    .login-card{width:min(430px,92vw);background:rgba(9,31,43,.9);border:1px solid rgba(93,172,199,.45);border-radius:18px;padding:26px 26px 22px;box-shadow:0 18px 38px rgba(0,0,0,.35);backdrop-filter:blur(4px);text-align:center}
    .brand{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:12px;font-weight:800;letter-spacing:.01em;--brand-logo-aspect:1}
    .brand .logo,
    .side-brand .logo{
      min-width:38px;
      width:var(--brand-logo-width,42px);
      height:var(--brand-logo-height,42px);
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--accent-soft);
      color:var(--accent2);
      font-weight:900;
      position:relative;
      overflow:hidden;
      padding:4px;
      transition:background .2s ease, box-shadow .2s ease, width .2s ease, height .2s ease;
    }
    .brand .logo span,
    .side-brand .logo span{transition:opacity .2s ease}
    .brand .logo-img,
    .side-brand .logo-img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:none;
    }
    .brand[data-has-logo="true"] .logo,
    .side-brand[data-has-logo="true"] .logo{
      background:transparent;
      padding:0;
      box-shadow:none;
    }
    .brand[data-has-logo="true"] .logo span,
    .side-brand[data-has-logo="true"] .logo span{display:none}
    .brand[data-has-logo="true"] .logo-img,
    .side-brand[data-has-logo="true"] .logo-img{
      display:block;
      filter:drop-shadow(0 2px 4px rgba(0,0,0,.18));
    }
    .brand[data-logo-shape="wide"] .logo,
    .side-brand[data-logo-shape="wide"] .logo{
      --brand-logo-width:clamp(56px, calc(42px * var(--brand-logo-aspect,1.4)), 160px);
    }
    .brand[data-logo-shape="tall"] .logo,
    .side-brand[data-logo-shape="tall"] .logo{
      --brand-logo-height:clamp(42px, calc(42px / clamp(.45, var(--brand-logo-aspect,1), 5)), 72px);
    }
    .login-card h1{margin:.2rem 0 10px;font-size:24px;letter-spacing:.01em}
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
    .login-card input{
      flex:1 1 180px; min-width:0; height:44px; border-radius:12px;
      border:1px solid rgba(93,172,199,.45); background:rgba(7,38,53,.8); color:#e6f6ff; padding:0 14px;
      transition:border .2s ease,box-shadow .2s ease,transform .2s ease;
    }
    .login-card input:focus-visible{border-color:#7dd7ff;box-shadow:0 0 0 3px rgba(98,196,228,.35);transform:translateY(-1px)}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      border:0; border-radius:12px; cursor:pointer; font-weight:600;
      height:44px; padding:0 16px; transition:transform .18s ease,box-shadow .18s ease,background .18s ease;
      touch-action:manipulation;
    }
    .btn.primary{background:var(--accent); color:#fff; box-shadow:0 10px 20px rgba(29,191,115,.24)}
    .btn.primary:hover{background:var(--accent2); transform:translateY(-1px); box-shadow:0 12px 24px rgba(22,160,98,.28)}
    .btn.primary:active{background:var(--accent3); transform:translateY(0);}
    .btn.ghost{background:rgba(255,255,255,.06); color:#d6f1ff; border:1px solid rgba(125,215,255,.45)}
    .btn.ghost:hover{background:rgba(255,255,255,.12); border-color:#7dd7ff; transform:translateY(-1px)}
    .btn.ghost:active{transform:translateY(0)}
    .msg{margin-top:10px; min-height:18px; color:#dfefff; font-size:14px}
    .hint{margin-top:6px; font-size:13px; color:rgba(223,239,255,.85); line-height:1.45}

    /* App layout */
    .app{display:grid; grid-template-columns:260px 1fr; min-height:100vh; max-height:100vh; position:relative; overflow:hidden}
    .sidebar{
      position:sticky; top:0; align-self:start; height:100vh;
      background:linear-gradient(190deg,var(--nav) 0%, var(--nav2) 100%);
      color:var(--nav-contrast-soft); padding:20px 16px; border-right:1px solid rgba(9,25,34,.72);
      transition:transform .25s ease, box-shadow .25s ease;
    }
    .side-brand{display:flex;align-items:center;gap:12px;margin-bottom:16px;position:relative;--brand-logo-aspect:1}
    .side-brand .name{font-weight:800;letter-spacing:.01em;color:var(--nav-contrast)}
    .nav{display:grid;gap:8px;margin-top:18px}
    .nav a{
      display:flex;gap:12px;align-items:center;
      padding:11px 14px;border-radius:12px;color:var(--nav-contrast-muted);border:1px solid transparent;text-decoration:none;font-weight:500;
      transition:background .2s ease,border-color .2s ease,transform .2s ease;
    }
    .nav a span[aria-hidden="true"]{font-size:18px}
    .nav a:hover{background:rgba(15,66,87,.65);border-color:rgba(30,107,136,.45);transform:translateX(3px)}
    .nav a.active{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.35);color:var(--nav-contrast);box-shadow:0 10px 22px rgba(0,0,0,.18)}
    .bottom{margin-top:auto;padding-top:18px;border-top:1px solid rgba(255,255,255,.08)}
    .logout{width:100%;gap:10px;background:rgba(255,255,255,.12);color:var(--nav-contrast)}
    .logout:hover{background:rgba(255,255,255,.18)}

    .main{display:flex;flex-direction:column;min-height:100vh;max-height:100vh;overflow-y:auto;background:linear-gradient(180deg,rgba(255,255,255,.78) 0%,rgba(255,255,255,.96) 100%)}
    .header{
      position:sticky;top:0;z-index:2;
      background:rgba(255,255,255,.92); backdrop-filter:blur(10px);
      border-bottom:1px solid var(--line);
      padding:14px 20px; display:flex; align-items:center; gap:18px; justify-content:space-between;
    }
    .header-main{display:flex;align-items:center;gap:12px;flex:1 1 auto;min-width:0}
    .header .title-wrap{display:grid;gap:4px;align-content:center}
    .header .title{font-weight:800; color:var(--ink);font-size:20px;letter-spacing:.01em}
    .header .subtitle{color:var(--muted);font-size:14px}
    .menu-toggle{
      display:none; align-items:center; justify-content:center;
      width:42px; height:42px; border-radius:11px; border:1px solid #d5e4ef;
      background:#fff; color:var(--nav); cursor:pointer; transition:background .2s ease,transform .2s ease;
    }
    .menu-toggle:hover{background:#eef6fb}
    .menu-toggle:focus-visible{outline:3px solid rgba(16,113,150,.25);}

    .viewer{flex:1 1 auto; position:relative; background:linear-gradient(180deg,#f6fafc 0%,#ffffff 60%);}
    .viewer iframe{
      position:absolute; inset:0; width:100%; height:100%;
      border:0; background:transparent; opacity:0; transition:opacity .24s ease;
    }
    .viewer iframe.loaded{opacity:1}
    .viewer-loading{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg,rgba(255,255,255,.85) 0%,rgba(255,255,255,.94) 60%);
      color:var(--muted); font-size:14px; gap:14px; text-align:left; padding:0 28px;
      transition:opacity .25s ease; opacity:1; visibility:visible;
    }
    .viewer-loading.hidden{opacity:0;pointer-events:none;visibility:hidden}
    .viewer-error{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      gap:18px; padding:0 28px; text-align:left;
      background:linear-gradient(180deg,rgba(255,255,255,.9) 0%,rgba(255,255,255,.98) 65%);
      color:var(--ink2); border-top:1px solid rgba(15,51,70,.08);
      transition:opacity .25s ease; opacity:0; visibility:hidden;
    }
    .viewer-error:not(.hidden){opacity:1;visibility:visible}
    .viewer-error .icon{font-size:28px;display:grid;place-items:center;width:48px;height:48px;border-radius:16px;background:rgba(255,90,95,.14);color:#d93025;box-shadow:0 12px 28px rgba(217,48,37,.18)}
    .viewer-error h3{margin:0 0 6px;font-size:18px;color:var(--ink)}
    .viewer-error p{margin:0 0 12px;color:var(--muted);font-size:14px;line-height:1.45;max-width:380px}
    .viewer-error .actions{display:flex;flex-wrap:wrap;gap:10px}
    .spinner{width:32px;height:32px;border-radius:50%;border:3px solid rgba(16,113,150,.18);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .btn.outline{
      background:transparent;
      color:var(--nav);
      border:1px solid rgba(16,113,150,.25);
      box-shadow:none;
    }
    .btn.outline:hover{background:rgba(16,113,150,.08);}
    .btn.outline:focus-visible{outline:3px solid rgba(16,113,150,.25);}

    .home-wrap{padding:28px 24px 40px;display:grid;gap:28px;content-visibility:auto;contain-intrinsic-size:780px;}
    .home-hero{display:grid;gap:10px;max-width:760px}
    .home-hero h2{margin:0;color:var(--ink);font-size:30px;letter-spacing:.01em}
    .home-hero p{margin:0;color:var(--muted);font-size:16px;line-height:1.5}
    .home-metrics{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));}
    .metric-card{display:flex;gap:14px;align-items:flex-start;padding:18px 20px;border-radius:18px;border:1px solid var(--line);background:linear-gradient(180deg,#ffffff 0%,#f9fcff 100%);box-shadow:0 12px 30px rgba(13,43,61,.12);min-height:112px;position:relative;overflow:hidden}
    .metric-icon{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:rgba(16,113,150,.12);color:var(--nav);font-size:22px;flex-shrink:0}
    .metric-content{display:grid;gap:6px;align-content:start}
    .metric-label{font-size:13px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);font-weight:600}
    .metric-value{font-size:28px;font-weight:800;color:var(--ink)}
    .metric-meta{font-size:13px;color:var(--muted);line-height:1.4}
    .session-chip{margin-left:auto;display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:14px;border:1px solid var(--line);background:rgba(255,255,255,.86);box-shadow:0 12px 28px rgba(13,43,61,.12);min-width:0}
    .session-chip.hidden{display:none}
    .session-role{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--accent2);background:rgba(29,191,115,.12);padding:2px 10px;border-radius:999px}
    .session-email{font-size:14px;color:var(--muted);white-space:nowrap;max-width:220px;overflow:hidden;text-overflow:ellipsis}
    .session-chip[data-role="admin"] .session-role{background:rgba(16,113,150,.12);color:var(--nav)}
    .session-chip[data-role="guest"] .session-role{background:rgba(15,51,70,.12);color:var(--muted)}
    .nav-backdrop{display:none}

    /* Responsive refinements */
    @media (max-width: 1180px){
      .home-hero h2{font-size:28px}
    }

    @media (max-width: 1024px){
      .app{grid-template-columns:1fr}
      .sidebar{position:fixed;inset:0 auto 0 0;width:280px;height:100vh;transform:translateX(-105%);box-shadow:0 20px 50px rgba(13,43,61,.45);z-index:5}
      body.nav-open .sidebar{transform:translateX(0);}
      .nav-backdrop{display:block;position:fixed;inset:0;background:var(--overlay);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:4}
      body.nav-open .nav-backdrop{opacity:1;pointer-events:auto}
      body.nav-open{overflow:hidden}
      .menu-toggle{display:inline-flex}
      .main{min-height:100vh}
      .hero-grid{grid-template-columns:1fr}
      .laptop-mock{max-width:520px;justify-self:center}
    }

    @media (max-width: 768px){
      .site-header{flex-wrap:wrap}
      .nav-links{flex-wrap:wrap}
    }

    @media (max-width:640px){
      .header{padding:12px 16px}
      .home-wrap{padding:24px 18px;contain-intrinsic-size:880px;}
      .metric-card{flex-direction:column;align-items:flex-start}
      .metric-icon{width:40px;height:40px;font-size:20px}
      .metric-value{font-size:24px}
      .session-chip{padding:8px 12px}
      .landing-hero h1{font-size:32px}
      .nav-links{gap:10px}
      .login-card{padding:20px}
    }
    
    /* ========================================
       EXECUTIVE COMMAND CENTER STYLES
       Mobile-First Responsive Design
       Integraci√≥n con Sistema de Temas Actual
    ======================================== */
    
    :root {
        /* COLORES DIN√ÅMICOS - SE LEEN DE LA APLICACI√ìN EXISTENTE */
        --primary-color: var(--accent, #1DBF73);
        --secondary-color: var(--accent2, #16a062);
        --accent-color: var(--accent, #1DBF73);
        --accent-dark: #16a062;
        --danger-color: #e74c3c;
        --warning-color: var(--muted, #6b7c8a);
        --success-color: var(--accent, #1DBF73);
        --muted-color: var(--muted, #6b7c8a);
        
        /* COLORES DE FONDO - LEER DE VARIABLES EXISTENTES */
        --text-primary: var(--ink, #0D2B3D);
        --text-secondary: var(--muted, #6b7c8a);
        --bg-primary: var(--bg, #f3f7fb);
        --bg-secondary: var(--bg2, #fbfdff);
        --border-color: var(--line, #e6eef5);
        
        /* COMPONENTES DE DISE√ëO */
        --shadow-light: 0 2px 8px rgba(0,0,0,0.1);
        --shadow-medium: 0 4px 16px rgba(0,0,0,0.15);
        --border-radius: 12px;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* ========================================
       DASHBOARD CONTAINER PRINCIPAL
    ======================================== */
    .executive-dashboard {
        background: var(--bg-primary);
        min-height: 100vh;
        padding: 1rem;
        transition: var(--transition);
    }
    
    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding: 1rem;
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-light);
    }
    
    .dashboard-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-primary);
        margin: 0;
    }
    
    .dashboard-subtitle {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin: 0.25rem 0 0 0;
    }
    
    /* ========================================
       ALERTS BANNER
    ======================================== */
    .alerts-banner {
        background: linear-gradient(135deg, var(--accent-soft, #E8FFF5), var(--bg-secondary));
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        padding: 1rem;
        margin-bottom: 1.5rem;
        box-shadow: var(--shadow-light);
    }
    
    .alert-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border-color);
        animation: fadeInUp 0.5s ease;
    }
    
    .alert-item:last-child {
        border-bottom: none;
    }
    
    .alert-icon {
        width: 20px;
        height: 20px;
        color: var(--warning-color);
        flex-shrink: 0;
    }
    
    .alert-content {
        flex: 1;
    }
    
    .alert-title {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.9rem;
        margin: 0 0 0.25rem 0;
    }
    
    .alert-time {
        font-size: 0.8rem;
        color: var(--text-secondary);
    }
    
    /* ========================================
       PERIOD SELECTOR
    ======================================== */
    .period-selector {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 2rem;
        padding: 0.5rem;
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-light);
        overflow-x: auto;
    }
    
    .period-btn {
        padding: 0.75rem 1.5rem;
        border: 1px solid var(--border-color);
        background: var(--bg-primary);
        color: var(--text-secondary);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition);
        white-space: nowrap;
        font-weight: 500;
    }
    
    .period-btn:hover {
        border-color: var(--accent-color);
        color: var(--accent-color);
    }
    
    .period-btn.active {
        background: var(--accent-color);
        color: white;
        border-color: var(--accent-color);
        box-shadow: 0 2px 8px rgba(29, 191, 115, 0.25);
    }
    
    /* ========================================
       KPI CARDS GRID
    ======================================== */
    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .action-toolbar {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.25rem;
        align-items: center;
        padding: 18px 20px;
        background: linear-gradient(120deg, rgba(29,191,115,.08), rgba(13,43,61,.05));
        border: 1px solid var(--border-color);
        border-radius: 16px;
        box-shadow: var(--shadow-light);
        margin-bottom: 2rem;
    }

    .action-text h3 { margin: 4px 0 6px; color: var(--text-primary); }
    .action-text p { margin: 0; color: var(--text-secondary); }
    .action-text .eyebrow { text-transform: uppercase; letter-spacing: .08em; font-size: 12px; color: var(--text-secondary); }

    .action-buttons { display:flex; flex-wrap:wrap; gap:10px; justify-content:flex-start; }
    .action-buttons .btn { height:auto; padding:10px 14px; }

    .kpi-card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        box-shadow: var(--shadow-light);
        transition: var(--transition);
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }
    
    .kpi-card:hover {
        box-shadow: var(--shadow-medium);
        transform: translateY(-2px);
    }
    
    .kpi-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
    }
    
    .kpi-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
    }
    
    .kpi-icon {
        width: 40px;
        height: 40px;
        background: var(--accent-soft);
        color: var(--accent-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        flex-shrink: 0;
    }
    
    .kpi-metrics {
        display: flex;
        align-items: baseline;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }
    
    .kpi-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-primary);
        line-height: 1;
    }
    
    .kpi-change {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.9rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        border-radius: 999px;
    }
    
    .kpi-change.positive {
        color: var(--success-color);
        background: rgba(29, 191, 115, 0.1);
    }
    
    .kpi-change.negative {
        color: var(--danger-color);
        background: rgba(231, 76, 60, 0.1);
    }
    
    .kpi-chart-container {
        height: 120px;
        margin-top: 1rem;
        position: relative;
    }
    
    .kpi-chart {
        width: 100%;
        height: 100%;
    }
    
    /* ========================================
       AI INTELLIGENCE PANEL
    ======================================== */
    .ai-intelligence-panel {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-light);
    }
    
    .ai-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--border-color);
    }
    
    .ai-panel-header h3 {
        margin: 0;
        color: var(--text-primary);
        font-size: 1.3rem;
        font-weight: 700;
    }
    
    .ai-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }
    
    .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--muted-color);
    }
    
    .status-dot.active {
        background: var(--success-color);
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    .ai-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }
    
    .ai-section h4 {
        margin: 0 0 1rem 0;
        color: var(--text-primary);
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    /* Predictions Grid */
    .predictions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
    }
    
    .prediction-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        transition: all 0.3s ease;
    }
    
    .prediction-item:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
    }
    
    .prediction-icon {
        width: 48px;
        height: 48px;
        background: var(--accent-soft);
        color: var(--accent-color);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        flex-shrink: 0;
    }
    
    .prediction-content {
        flex: 1;
    }
    
    .prediction-title {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 0.5rem;
    }
    
    .prediction-value {
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.25rem;
    }
    
    .prediction-trend {
        font-size: 0.9rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        border-radius: 999px;
    }
    
    .prediction-trend.up {
        color: var(--success-color);
        background: rgba(29, 191, 115, 0.1);
    }
    
    .prediction-trend.down {
        color: var(--danger-color);
        background: rgba(231, 76, 60, 0.1);
    }
    
    .prediction-confidence {
        font-size: 0.8rem;
        color: var(--muted-color);
    }
    
    /* Recommendations List */
    .recommendations-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    .recommendation-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1.5rem;
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        transition: all 0.3s ease;
    }
    
    .recommendation-item:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
    }
    
    .recommendation-item.priority-high {
        border-left: 4px solid var(--danger-color);
    }
    
    .recommendation-item.priority-medium {
        border-left: 4px solid #f39c12;
    }
    
    .recommendation-item.priority-low {
        border-left: 4px solid var(--success-color);
    }
    
    .rec-priority {
        background: var(--muted-color);
        color: white;
        font-size: 0.8rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        border-radius: 999px;
        white-space: nowrap;
        flex-shrink: 0;
    }
    
    .recommendation-item.priority-high .rec-priority {
        background: var(--danger-color);
    }
    
    .recommendation-item.priority-medium .rec-priority {
        background: #f39c12;
    }
    
    .recommendation-item.priority-low .rec-priority {
        background: var(--success-color);
    }
    
    .rec-content {
        flex: 1;
    }
    
    .rec-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
    }
    
    .rec-description {
        color: var(--text-secondary);
        line-height: 1.5;
        margin-bottom: 1rem;
    }
    
    .rec-actions {
        display: flex;
        gap: 0.5rem;
    }
    
    .rec-btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .rec-btn.primary {
        background: var(--accent-color);
        color: white;
    }
    
    .rec-btn.primary:hover {
        background: var(--accent-dark);
        transform: translateY(-1px);
    }
    
    .rec-btn.secondary {
        background: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border-color);
    }
    
    .rec-btn.secondary:hover {
        background: var(--bg-secondary);
    }
    
    /* Patterns Grid */
    .patterns-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
    }
    
    .pattern-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        transition: all 0.3s ease;
    }
    
    .pattern-item:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
    }
    
    .pattern-icon {
        width: 40px;
        height: 40px;
        background: var(--accent-soft);
        color: var(--accent-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        margin-bottom: 1rem;
    }
    
    .pattern-content {
        flex: 1;
    }
    
    .pattern-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
    }
    
    .pattern-description {
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
    }
    
    .pattern-impact {
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--accent-color);
    }
    
    /* ========================================
       DRILLDOWN MODAL
    ======================================== */
    .drilldown-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        backdrop-filter: blur(4px);
    }
    
    .drilldown-content {
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-medium);
        max-width: 90vw;
        max-height: 90vh;
        overflow: auto;
        animation: modalSlideIn 0.3s ease;
    }
    
    .drilldown-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        border-bottom: 1px solid var(--border-color);
    }
    
    .drilldown-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
    }
    
    .drilldown-close {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        padding: 0.5rem;
        border-radius: var(--border-radius);
        transition: var(--transition);
    }
    
    .drilldown-close:hover {
        background: var(--border-color);
        color: var(--text-primary);
    }
    
    .drilldown-body {
        padding: 1.5rem;
    }
    
    /* ========================================
       ANIMATIONS
    ======================================== */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }
    
    /* ========================================
       RESPONSIVE DESIGN
    ======================================== */
    @media (max-width: 768px) {
        .executive-dashboard {
            padding: 0.5rem;
        }
        
        .dashboard-header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }
        
        .dashboard-title {
            font-size: 1.5rem;
        }
        
        .kpi-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .ai-intelligence-panel {
            padding: 1rem;
        }
        
        .ai-panel-header {
            flex-direction: column;
            gap: 0.5rem;
            text-align: center;
        }
        
        .predictions-grid {
            grid-template-columns: 1fr;
        }
        
        .recommendation-item {
            padding: 1rem;
        }
        
        .rec-actions {
            flex-direction: column;
        }
        
        .patterns-grid {
            grid-template-columns: 1fr;
        }
        
        .kpi-card {
            padding: 1rem;
        }
        
        .kpi-value {
            font-size: 2rem;
        }
        
        .period-selector {
            justify-content: center;
        }
        
        .drilldown-content {
            margin: 1rem;
            max-width: calc(100vw - 2rem);
            max-height: calc(100vh - 2rem);
        }
        
        .drilldown-header {
            padding: 1rem;
        }
        
        .drilldown-title {
            font-size: 1.25rem;
        }
        
        .drilldown-body {
            padding: 1rem;
        }
    }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <section class="login-wrap" id="loginView" aria-labelledby="loginTitle">
    <div class="landing-shell" id="landingShell">
      <div class="landing-hero">
        <div class="hero-wrap">
          <header class="site-header">
            <div class="brand" id="landingBrand" data-has-logo="false"><div class="logo"><span>GS</span><img class="logo-img" id="landingBrandLogo" alt="Logotipo corporativo" /></div><div class="brand-name" id="landingBrandName">Gesti√≥n Sostenible</div></div>
            <nav class="nav-links" aria-label="Navegaci√≥n de la landing">
              <a href="#que-es">Funciones</a>
              <a href="#por-que">Beneficios</a>
              <a href="#como">C√≥mo funciona</a>
              <a class="btn ghost" href="#loginPanel" data-action="focus-login">Iniciar sesi√≥n</a>
            </nav>
          </header>
          <div class="hero-grid">
            <div>
              <div class="login-pill">Plataforma operativa</div>
              <h1>Digitaliz√° tu gesti√≥n.<br/>Gan√° tiempo, sum√° impacto.</h1>
              <p>Administr√° clientes, agenda de retiros, finanzas y checklist fiscal en un √∫nico escritorio. Simple, r√°pido y seguro.</p>
              <div class="login-cta">
                <a class="btn primary" href="#loginPanel" data-action="focus-login">Iniciar sesi√≥n</a>
                <a class="btn ghost" href="#que-es">Ver funciones</a>
              </div>
            </div>
            <div class="laptop-mock" aria-hidden="true">
              <div class="laptop-top">
                <div class="laptop-camera"></div>
                <img src="assets/dashboard-preview.svg" alt="Vista del dashboard de Gesti√≥n Sostenible" class="laptop-screen" loading="lazy" />
              </div>
              <div class="laptop-base"></div>
            </div>
          </div>
        </div>
      </div>

      <section class="feature-section" id="que-es">
        <div class="wrap">
          <div class="kicker">Un sistema, todas tus operaciones</div>
          <h2>Todo en un solo lugar</h2>
          <p style="max-width:760px;margin:.4rem 0 1.2rem;color:var(--muted)">Automatiz√° las tareas del d√≠a a d√≠a: agenda y rutas en Google Maps, gesti√≥n de clientes, cobranzas y checklist fiscal con adjuntos. Sin planillas, sin duplicados.</p>
          <div class="feature-grid">
            <div class="card"><div class="pill">Calendario</div><h3>Retiros con rutas</h3><p>Planific√° y visualiz√° la ruta del d√≠a integrando direcciones con Google Maps y estados de retiro.</p></div>
            <div class="card"><div class="pill">Clientes</div><h3>Gesti√≥n en tiempo real</h3><p>Altas, b√∫squeda, contratos mensuales y montos. Todo sincronizado en tiempo real.</p></div>
            <div class="card"><div class="pill">Finanzas</div><h3>Cobros + DGI</h3><p>Pagos pendientes/recibidos y checklist fiscal mensual con adjuntos vinculados.</p></div>
          </div>
        </div>
      </section>

      <section class="feature-section" id="por-que">
        <div class="wrap">
          <div class="kicker">Eficiencia, control y sustentabilidad</div>
          <h2>¬øPor qu√© elegir Gesti√≥n Sostenible?</h2>
          <div class="feature-grid" style="margin-top:12px">
            <div class="card"><h3>‚ö° Operaciones en vivo</h3><p>Datos siempre actualizados, sin recargas completas ni planillas paralelas.</p></div>
            <div class="card"><h3>üîí Seguridad y roles</h3><p>Accesos por perfil (Administrador / Control). Autenticaci√≥n y permisos coherentes.</p></div>
            <div class="card"><h3>üìà Escalable</h3><p>Sum√° usuarios, clientes y m√≥dulos sin cambiar de sistema. Hosting est√°tico, costos bajos.</p></div>
          </div>
        </div>
      </section>

      <section class="feature-section" id="como">
        <div class="wrap">
          <div class="kicker">Simple y directo</div>
          <h2>Tu gesti√≥n en 3 pasos</h2>
          <div class="steps" style="margin-top:12px">
            <div class="card step"><div class="num">1</div><h3>Inici√° sesi√≥n</h3><p>Acced√© con tu usuario corporativo y manten√© la sesi√≥n activa entre m√≥dulos.</p></div>
            <div class="card step"><div class="num">2</div><h3>Organiz√° y oper√°</h3><p>Agenda de retiros, clientes y cobranzas desde un solo escritorio.</p></div>
            <div class="card step"><div class="num">3</div><h3>Control√° resultados</h3><p>Seguimiento de indicadores clave y checklist fiscal actualizado cada mes.</p></div>
          </div>
        </div>
      </section>

      <!-- CTA final removida para evitar mensajes repetidos de inicio de sesi√≥n -->
    </div>

    <section class="login-panel" id="loginPanel">
      <div class="login-card">
        <div class="brand" id="loginBrand" data-has-logo="false"><div class="logo" aria-hidden="true"><span>GS</span><img class="logo-img" id="loginBrandLogo" alt="Logotipo corporativo" /></div><div id="loginBrandName">Gesti√≥n Sostenible</div></div>
        <h1 id="loginTitle">Iniciar sesi√≥n</h1>
        <form class="row" style="margin:10px 0 6px;justify-content:center" id="loginForm" method="post" novalidate>
          <label class="sr-only" for="email">Correo electr√≥nico</label>
          <input id="email" name="email" type="email" placeholder="usuario@gestionsostenible.com" autocomplete="username" required>
          <label class="sr-only" for="pass">Contrase√±a</label>
          <input id="pass" name="password" type="password" placeholder="Contrase√±a" autocomplete="current-password" required>
          <button class="btn primary" id="btnLogin" type="submit">Entrar</button>
        </form>
        <div class="msg" id="loginMsg" role="status" aria-live="polite"></div>
      </div>
    </section>
  </section>

  <!-- APP -->
  <section class="app hidden" id="appView">
    <aside class="sidebar" aria-label="Navegaci√≥n principal">
      <div class="side-brand" id="sideBrand" data-has-logo="false"><div class="logo"><span>GS</span><img class="logo-img" id="sideBrandLogo" alt="Logotipo corporativo" /></div><div class="name" id="sideBrandName">Gesti√≥n Sostenible</div></div>
      <nav class="nav" id="sideNav" aria-label="Secciones de la aplicaci√≥n">
        <a href="#/"            data-page="/"          data-module-key="home"          class="active"><span aria-hidden="true">üè†</span> <span>Inicio</span></a>
        <a href="#/clientes"    data-page="clientes-firestore.html" data-module-key="clientes"><span aria-hidden="true">üë§</span> <span>Clientes</span></a>
        <a href="#/retiros"     data-page="retiros.html"             data-module-key="rutas"><span aria-hidden="true">üó∫Ô∏è</span> <span>Calendario / Rutas</span></a>
        <a href="#/finanzas"    data-page="finanzas.html"           data-module-key="finanzas"><span aria-hidden="true">üíµ</span> <span>Finanzas y DGI</span></a>
        <a href="#/temas"       data-page="temas.html"              data-module-key="temas" data-permission="manageTheme"><span aria-hidden="true">üé®</span> <span>Temas</span></a>
        <a href="#/usuarios"    data-page="usuarios.html"           data-module-key="usuarios" data-permission="manageUsers"><span aria-hidden="true">üõ°Ô∏è</span> <span>Gesti√≥n de Cuentas</span></a>
        <a href="#/configuracion" data-page="configuracion.html"    data-module-key="configuracion"><span aria-hidden="true">‚öôÔ∏è</span> <span>Configuraci√≥n</span></a>
      </nav>
      <div class="bottom">
        <button class="btn logout" id="btnLogout" type="button"><span aria-hidden="true">üö™</span> <span>Cerrar sesi√≥n</span></button>
      </div>
    </aside>

    <main class="main" role="main">
      <div class="header" role="presentation">
        <div class="header-main">
          <button class="menu-toggle" id="navToggle" type="button" aria-label="Abrir men√∫" aria-controls="sideNav" aria-expanded="false">‚ò∞</button>
          <div class="title-wrap">
            <div class="title" id="pageTitle">Inicio</div>
            <div class="subtitle" id="pageSubtitle">Resumen ejecutivo de tus indicadores clave.</div>
          </div>
        </div>
        <div class="session-chip hidden" id="sessionChip" role="status" aria-live="polite" data-role="guest">
          <span class="session-role" id="sessionRole">Invitado</span>
          <span class="session-email" id="sessionEmail">Sin sesi√≥n activa</span>
        </div>
      </div>
      <div class="viewer" id="viewer">
        <!-- Home (inline) -->
        <!-- Executive Command Center -->
        <div id="homeView" class="home-wrap" aria-live="polite">
          <!-- Dashboard Principal -->
          <div class="executive-dashboard" id="executiveDashboard">
            
            <!-- Alerts Banner -->
            <div class="alerts-banner" id="alertsBanner">
              <h3 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">
                <svg width="20" height="20" style="vertical-align: middle; margin-right: 0.5rem;" fill="currentColor">
                  <use href="#icon-alert"></use>
                </svg>
                Alertas del Sistema
              </h3>
              <div class="alerts-content" id="alertsContent">
                <!-- Las alertas se cargan din√°micamente -->
              </div>
            </div>

            <!-- Period Selector -->
            <div class="period-selector" id="periodSelector">
              <button class="period-btn active" data-period="today">Hoy</button>
              <button class="period-btn" data-period="week">Esta Semana</button>
              <button class="period-btn" data-period="month">Este Mes</button>
              <button class="period-btn" data-period="quarter">Este Trimestre</button>
              <button class="period-btn" data-period="year">Este A√±o</button>
            </div>

            <!-- KPI Cards Grid (datos primero) -->
            <div class="kpi-grid" id="kpiGrid">

              <!-- Retiros Programados Card -->
              <div class="kpi-card" data-kpi="retiros" data-module="retiros.html">
                <div class="kpi-header">
                  <h3 class="kpi-title">Retiros Programados</h3>
                  <div class="kpi-icon">üìÖ</div>
                </div>
                <div class="kpi-metrics">
                  <div class="kpi-value" id="retirosValue">‚Äî</div>
                  <div class="kpi-change positive" id="retirosChange">
                    <svg width="16" height="16" fill="currentColor">
                      <use href="#icon-trending-up"></use>
                    </svg>
                    <span id="retirosChangeValue">‚Äî</span>
                  </div>
                </div>
                <div class="kpi-chart-container">
                  <canvas class="kpi-chart" id="retirosChart"></canvas>
                </div>
              </div>

              <!-- Ingresos Diarios Card -->
              <div class="kpi-card" data-kpi="ingresos" data-module="finanzas.html">
                <div class="kpi-header">
                  <h3 class="kpi-title">Ingresos Diarios</h3>
                  <div class="kpi-icon">üí∞</div>
                </div>
                <div class="kpi-metrics">
                  <div class="kpi-value" id="ingresosValue">‚Äî</div>
                  <div class="kpi-change positive" id="ingresosChange">
                    <svg width="16" height="16" fill="currentColor">
                      <use href="#icon-trending-up"></use>
                    </svg>
                    <span id="ingresosChangeValue">‚Äî</span>
                  </div>
                </div>
                <div class="kpi-chart-container">
                  <canvas class="kpi-chart" id="ingresosChart"></canvas>
                </div>
              </div>

              <!-- Eficiencia Operativa Card -->
              <div class="kpi-card" data-kpi="eficiencia" data-module="configuracion.html">
                <div class="kpi-header">
                  <h3 class="kpi-title">Eficiencia Operativa</h3>
                  <div class="kpi-icon">‚ö°</div>
                </div>
                <div class="kpi-metrics">
                  <div class="kpi-value" id="eficienciaValue">‚Äî</div>
                  <div class="kpi-change positive" id="eficienciaChange">
                    <svg width="16" height="16" fill="currentColor">
                      <use href="#icon-trending-up"></use>
                    </svg>
                    <span id="eficienciaChangeValue">‚Äî</span>
                  </div>
                </div>
                <div class="kpi-chart-container">
                  <canvas class="kpi-chart" id="eficienciaChart"></canvas>
                </div>
              </div>

            </div>

            <!-- Acciones r√°pidas alineadas a datos -->
            <div class="action-toolbar" id="actionToolbar">
              <div class="action-text">
                <p class="eyebrow">Acciones inmediatas</p>
                <h3>Gestion√° sin salir del tablero</h3>
                <p>Usa datos en vivo para actuar: altas, cobros, rutas y reportes.</p>
              </div>
              <div class="action-buttons">
                <button class="btn primary" type="button" onclick="openModuleAndSendAction('clientes', { type:'gs-action', action:'focus-alta' })">‚ûï Alta de cliente</button>
                <button class="btn secondary" type="button" onclick="openModuleAndSendAction('finanzas', { type:'gs-action', action:'finanzas:registrar' })">üíµ Registrar cobro</button>
                <button class="btn secondary" type="button" onclick="openModuleAndSendAction('rutas', { type:'gs-action', action:'rutas:optimizar' })">üó∫Ô∏è Optimizar rutas</button>
                <button class="btn primary" type="button" onclick="downloadKPIReport('ingresos', 'pdf')">üìÑ Exportar informe AI</button>
              </div>
            </div>

            <!-- AI Intelligence Panel -->
            <div class="ai-intelligence-panel" id="aiIntelligencePanel">
              <div class="ai-panel-header">
                <h3>ü§ñ AI Intelligence Layer</h3>
                <div class="ai-status" id="aiStatus">
                  <span class="status-dot active"></span>
                  <span>An√°lisis en tiempo real</span>
                </div>
              </div>
              <div class="ai-content">
                <!-- Predicciones -->
                <div class="ai-section">
                  <h4>üìà Predicciones Pr√≥ximos 7 D√≠as</h4>
                  <div class="predictions-grid" id="predictionsGrid">
                    <div class="prediction-item" data-prediction="retiros">
                      <div class="prediction-icon">üìÖ</div>
                      <div class="prediction-content">
                        <div class="prediction-title">Retiros Estimados</div>
                        <div class="prediction-value">‚Äî</div>
                        <div class="prediction-confidence">Confianza: ‚Äî</div>
                      </div>
                    </div>
                    <div class="prediction-item" data-prediction="ingresos">
                      <div class="prediction-icon">üí∞</div>
                      <div class="prediction-content">
                        <div class="prediction-title">Ingresos Proyectados</div>
                        <div class="prediction-value">‚Äî</div>
                        <div class="prediction-confidence">Confianza: ‚Äî</div>
                      </div>
                    </div>
                    <div class="prediction-item" data-prediction="eficiencia">
                      <div class="prediction-icon">‚ö°</div>
                      <div class="prediction-content">
                        <div class="prediction-title">Eficiencia Esperada</div>
                        <div class="prediction-value">‚Äî</div>
                        <div class="prediction-confidence">Confianza: ‚Äî</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Recomendaciones IA -->
                <div class="ai-section">
                  <h4>üí° Recomendaciones Inteligentes</h4>
                  <div class="recommendations-list" id="recommendationsList">
                    <div class="recommendation-item priority-high">
                      <div class="rec-priority">Alto</div>
                      <div class="rec-content">
                        <div class="rec-title">Optimizar rutas del Zona Norte</div>
                        <div class="rec-description">La IA detect√≥ patrones de ineficiencia en 3 rutas. Redistribuir 15% del volumen podr√≠a mejorar 8.5% la eficiencia.</div>
                        <div class="rec-actions">
                          <button class="rec-btn primary" onclick="implementRecommendation('optimize_routes')">Implementar</button>
                          <button class="rec-btn secondary" onclick="viewRecommendationDetails('optimize_routes')">Detalles</button>
                        </div>
                      </div>
                    </div>
                    <div class="recommendation-item priority-medium">
                      <div class="rec-priority">Medio</div>
                      <div class="rec-content">
                        <div class="rec-title">Ajustar horarios de retiro</div>
                        <div class="rec-description">Clientes en zona Sur prefieren horarios 8-10 AM. Reducir cancelaciones estimadas en 23%.</div>
                        <div class="rec-actions">
                          <button class="rec-btn primary" onclick="implementRecommendation('adjust_schedule')">Implementar</button>
                          <button class="rec-btn secondary" onclick="viewRecommendationDetails('adjust_schedule')">Detalles</button>
                        </div>
                      </div>
                    </div>
                    <div class="recommendation-item priority-low">
                      <div class="rec-priority">Bajo</div>
                      <div class="rec-content">
                        <div class="rec-title">Mantenimiento preventivo</div>
                        <div class="rec-description">Veh√≠culo #7 requiere mantenimiento en 3 d√≠as seg√∫n patrones de uso. Programar para evitar interrupciones.</div>
                        <div class="rec-actions">
                          <button class="rec-btn primary" onclick="implementRecommendation('maintenance')">Programar</button>
                          <button class="rec-btn secondary" onclick="viewRecommendationDetails('maintenance')">Detalles</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Detecci√≥n de Patrones -->
                <div class="ai-section">
                  <h4>üîç Patrones Detectados</h4>
                  <div class="patterns-grid" id="patternsGrid">
                    <div class="pattern-item">
                      <div class="pattern-icon">üìä</div>
                      <div class="pattern-content">
                        <div class="pattern-title">Incremento 15% volumen</div>
                        <div class="pattern-description">√öltima semana vs anterior en zona Este</div>
                        <div class="pattern-impact">Impacto: +$12,300/mes</div>
                      </div>
                    </div>
                    <div class="pattern-item">
                      <div class="pattern-icon">‚ö†Ô∏è</div>
                      <div class="pattern-content">
                        <div class="pattern-title">Cancelaciones altas</div>
                        <div class="pattern-description">Horarios 14-16 PM tienen 18% m√°s cancelaciones</div>
                        <div class="pattern-impact">Impacto: -$8,500/mes</div>
                      </div>
                    </div>
                    <div class="pattern-item">
                      <div class="pattern-icon">‚úÖ</div>
                      <div class="pattern-content">
                        <div class="pattern-title">Clientes recurrentes</div>
                        <div class="pattern-description">92% de clientes vuelven en 30 d√≠as</div>
                        <div class="pattern-impact">LTV promedio: $2,400</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
          
          <!-- Drilldown Modal -->
          <div class="drilldown-modal hidden" id="drilldownModal">
            <div class="drilldown-content">
              <div class="drilldown-header">
                <h3 class="drilldown-title" id="drilldownTitle">Detalles</h3>
                <button class="drilldown-close" id="drilldownClose">
                  <svg width="24" height="24" fill="currentColor">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                  </svg>
                </button>
              </div>
              <div class="drilldown-body" id="drilldownBody">
                <!-- El contenido detallado se carga din√°micamente -->
              </div>
            </div>
          </div>
          
        </div>
        <!-- M√≥dulos -->
        <div class="viewer-loading hidden" id="viewerLoading" aria-live="polite" aria-atomic="true">
          <div class="spinner" role="presentation"></div>
          <div>
            <div id="viewerLoadingTitle" style="font-weight:600;color:var(--ink)">Gesti√≥n Sostenible ¬∑ Cargando</div>
            <div id="viewerLoadingText">Sincronizando la vista con tu sesi√≥n.</div>
          </div>
        </div>
        <div class="viewer-error hidden" id="viewerError" role="alert">
          <div class="icon" aria-hidden="true">‚ö†Ô∏è</div>
          <div>
            <h3 id="viewerErrorTitle">No pudimos abrir el m√≥dulo.</h3>
            <p id="viewerErrorText">Revis√° tu conexi√≥n o que el archivo exista en el servidor antes de reintentar.</p>
            <div class="actions">
              <button type="button" class="btn outline" id="viewerErrorRetry">Reintentar carga</button>
              <button type="button" class="btn primary" id="viewerErrorHome">Volver al inicio</button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </section>
  <div class="nav-backdrop" id="navBackdrop" hidden></div>

  <!-- Chart.js para Executive Command Center -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  
  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>

  <!-- Auth compartido (ya lo ten√©s) -->
  <script src="assets/demo-data.js"></script>
  <script src="assets/gs-auth.js"></script>

  <script src="assets/config.js"></script>
  <script src="assets/analytics.js"></script>
  <script src="assets/session.js"></script>
  <script src="assets/theme.js"></script>
  <script src="assets/router.js"></script>
  <script src="assets/app-shell.js"></script>

  <!-- SVG Icons para Executive Command Center -->
  <svg width="0" height="0" class="sr-only">
    <symbol id="icon-refresh" viewBox="0 0 24 24">
      <path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    </symbol>
    <symbol id="icon-trending-up" viewBox="0 0 24 24">
      <path fill="currentColor" d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
    </symbol>
    <symbol id="icon-trending-down" viewBox="0 0 24 24">
      <path fill="currentColor" d="M16 18l2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4-6.3-6.29L22 12v6z"/>
    </symbol>
    <symbol id="icon-alert" viewBox="0 0 24 24">
      <path fill="currentColor" d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
    </symbol>
  </svg>

</body>
</html>



